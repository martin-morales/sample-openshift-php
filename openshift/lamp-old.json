{
	"kind": "Template",
	"apiVersion": "v1",
	"metadata": {
		"name": "lamp-example",
		"annotations": {
			"openshift.io/display-name": "PHP + MySql (Persistent)",
			"description": "A simple two-tier application to demonstate a CI/CD pipeline froms scratch.",
			"tags": "quickstart,php",
			"iconClass": "icon-php",
			"openshift.io/long-description": "This template defines resources needed to develop a LAMP application, including a build configuration, application deployment configuration, and database deployment configuration. The database is stored in persistent storage.",
			"openshift.io/provider-display-name": "Harris Corporation - Martin Morales",
			"openshift.io/documentation-url": "https://github.com/martin-morales/sample-openshift-php",
			"template.openshift.io/bindable": "false"
		}
	},
	"message": "The following service(s) have been created in your project: ${NAME}, ${DATABASE_SERVICE_NAME}.",
	"labels": {
		"template": "lamp-example",
		"app": "lamp-example"
	},
	"objects": [
		{
			"kind": "Service",
			"apiVersion": "v1",
			"metadata": {
				"name": "${NAME}",
				"annotations": {
					"description": "Exposes and load balances the application pods",
					"service.alpha.openshift.io/dependencies": "[{\"name\": \"${DATABASE_SERVICE_NAME}\", \"kind\": \"Service\"}]"
				}
			},
			"spec": {
				"ports": [
					{
						"name": "web",
						"port": 8080,
						"targetPort": 8080
					}
				],
				"selector": {
					"name": "${NAME}"
				}
			}
		},
		{
			"kind": "Route",
			"apiVersion": "v1",
			"metadata": {
				"name": "${NAME}"
			},
			"spec": {
				"host": "${APPLICATION_DOMAIN}",
				"to": {
					"kind": "Service",
					"name": "${NAME}"
				}
			}
		},
		{
			"kind": "Service",
			"apiVersion": "v1",
			"metadata": {
				"name": "${DATABASE_SERVICE_NAME}",
				"annotations": {
					"description": "Exposes the database server"
				}
			},
			"spec": {
				"ports": [
					{
						"name": "sampledb",
						"protocol": "TCP",
						"port": 3306,
						"targetPort": 3306
					}
				],
				"selector": {
					"name": "${DATABASE_SERVICE_NAME}"
				}
			}
		}
	],
	"parameters": [
		{
			"name": "NAME",
			"displayName": "Name",
			"description": "The name assigned to all of the frontend objects defined in this template.",
			"required": true,
			"value": "lamp-example"
		},
		{
			"name": "NAMESPACE",
			"displayName": "Namespace",
			"description": "The OpenShift Namespace where the ImageStream resides.",
			"required": true,
			"value": "openshift"
		},
		{
			"name": "PHP_VERSION",
			"displayName": "PHP Version",
			"description": "Version of PHP to be used.",
			"required": true,
			"value": "7.1"
		},
		{
			"name": "DATABASE_VERSION",
			"displayName": "MySQL Version",
			"description": "Version of MySQL to be used.",
			"required": true,
			"value": "5.7"
		},
		{
			"name": "MEMORY_LIMIT",
			"displayName": "Memory Limit",
			"description": "Maximum amount of memory the PHP container can use.",
			"required": true,
			"value": "512Mi"
		},
		{
			"name": "MEMORY_MYSQL_LIMIT",
			"displayName": "Memory Limit",
			"description": "Maximum amount of memory the MySQL container can use.",
			"required": true,
			"value": "512Mi"
		},
		{
			"name": "SOURCE_REPOSITORY_URL",
			"displayName": "Git Repository URL",
			"description": "The URL of the repository with your application source code.",
			"required": true,
			"value": "https://github.com/martin-morales/sample-openshift-php"
		},
		{
			"name": "SOURCE_REPOSITORY_REF",
			"displayName": "Git Reference",
			"description": "Set this to a branch name, tag or other ref of your repository if you are not using the default branch."
		},
		{
			"name": "CONTEXT_DIR",
			"displayName": "Context Directory",
			"description": "Set this to the relative path to your project if it is not in the root of your repository."
		},
		{
			"name": "APPLICATION_DOMAIN",
			"displayName": "Application Hostname",
			"description": "The exposed hostname that will route to the Node.js service, if left blank a value will be defaulted.",
			"value": ""
		},
		{
			"name": "GITHUB_WEBHOOK_SECRET",
			"displayName": "GitHub Webhook Secret",
			"description": "Github trigger secret.  A difficult to guess string encoded as part of the webhook URL.  Not encrypted.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{40}"
		},
		{
			"name": "GENERIC_WEBHOOK_SECRET",
			"displayName": "Generic Webhook Secret",
			"description": "A secret string used to configure the Generic webhook.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{40}"
		},
		{
			"name": "DATABASE_SERVICE_NAME",
			"displayName": "Database Service Name",
			"required": true,
			"value": "mysqldb"
		},
		{
			"name": "DATABASE_USER",
			"displayName": "MongoDB Username",
			"description": "Username for MySQL user that will be used for accessing the database.",
			"generate": "expression",
			"from": "user[A-Z0-9]{3}"
		},
		{
			"name": "DATABASE_PASSWORD",
			"displayName": "MongoDB Password",
			"description": "Password for the MongoDB user.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{16}"
		},
		{
			"name": "DATABASE_NAME",
			"displayName": "Database Name",
			"required": true,
			"value": "sampledb"
		},
		{
			"name": "DATABASE_ADMIN_PASSWORD",
			"displayName": "Database Administrator Password",
			"description": "Password for the database admin user.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{16}"
		},
	]
}