{
	"kind": "Template",
	"apiVersion": "v1",
	"metadata": {
		"name": "lamp-example",
		"annotations": {
			"openshift.io/display-name": "PHP + MySql (Persistent)",
			"description": "A simple two-tier application to demonstate a CI/CD pipeline froms scratch.",
			"tags": "quickstart,php",
			"iconClass": "icon-php",
			"openshift.io/long-description": "This template defines resources needed to develop a LAMP application, including a build configuration, application deployment configuration, and database deployment configuration. The database is stored in persistent storage.",
			"openshift.io/provider-display-name": "Harris Corporation - Martin Morales",
			"openshift.io/documentation-url": "https://github.com/martin-morales/sample-openshift-php",
			"template.openshift.io/bindable": "false"
		}
	},
	"message": "The following service(s) have been created in your project: ${NAME}, ${DATABASE_SERVICE_NAME}.",
	"labels": {
		"template": "lamp-example",
		"app": "lamp-example"
	},
	"objects": [
		{
			"kind": "Secret",
			"apiVersion": "v1",
			"metadata": {
				"name": "${NAME}-${DATABASE_SERVICE_NAME}"
			},
			"stringData": {
				"database-name": "${DATABASE_NAME}",
				"database-username": "${DATABASE_USER}",
				"database-password": "${DATABASE_PASSWORD}",
				"database-root-password": "${DATABASE_ADMIN_PASSWORD}"
			}
		},
		{
			"kind": "DeploymentConfig",
			"apiVersion": "v1",
			"metadata": {
				"name": "${DATABASE_SERVICE_NAME}"
			},
			"spec": {
				"strategy": {
					"type": "Recreate"
				},
				"triggers": {
					"type": "ConfigChange"
				},
				"replicas": 1,
				"selector": {
					"name": "${DATABASE_SERVICE_NAME}"
				},
				"template": {
					"metadata": {
						"labels": {
							"name": "${DATABASE_SERVICE_NAME}"
						}
					},
					"spec": {
						"volumes": [
							{
								"name": "${DATABASE_SERVICE_NAME}-data",
								"persistentVolumeClaim": {
									"claimName": "{DATABASE_SERVICE_NAME}"
								}
							}
						],
						"containers": [
							{
								"name": "server",
								"image": "openshift/mysql-57-centos7",
								"command": [
									"run-${DATABASE_SERVICE_NAME}"
								],
								"ports": [
									{
										"containerPort": 3306,
										"protocol": "TCP"
									}
								],
								"env": [
								],
								"volumeMounts": [
									{
										"name": "${DATABASE_SERVICE_NAME}-data",
										"mountPath": "/var/lib/mysql/data"
									}
								],
								"resources": " ",
								"terminationMessagePath": "/dev/termination-log",
								"imagePullPolocy": "IfNotPresent",
								"securityContext": {
									"capabilities": " ",
									"privileged": false
								}
							}
						],
						"restartPolicy": "Always",
						"dnsPolicy": "ClusterFirst"
					}
				}
			}
		}
	],
	"parameters": [
		{
			"name": "NAME",
			"displayName": "Name",
			"description": "The name assigned to all of the frontend objects defined in this template.",
			"required": true,
			"value": "lamp-example"
		},
		{
			"name": "NAMESPACE",
			"displayName": "Namespace",
			"description": "The OpenShift Namespace where the ImageStream resides.",
			"required": true,
			"value": "openshift"
		},
		{
			"name": "APPLICATION_DOMAIN",
			"displayName": "Application Hostname",
			"description": "The exposed hostname that will route to the Node.js service, if left blank a value will be defaulted.",
			"value": ""
		},
		{
			"name": "PHP_VERSION",
			"displayName": "PHP Version",
			"description": "Version of PHP to be used.",
			"required": true,
			"value": "7.1"
		},
		{
			"name": "DATABASE_VERSION",
			"displayName": "MySQL Version",
			"description": "Version of MySQL to be used.",
			"required": true,
			"value": "5.7"
		},
		{
			"name": "DATABASE_SERVICE_NAME",
			"displayName": "Database Service Name",
			"required": true,
			"value": "mysqldb"
		},
		{
			"name": "DATABASE_IMAGE_NAME",
			"displayName": "Database Image Name",
			"required": true,
			"value": "mysql"
		},
		{
			"name": "DATABASE_USER",
			"displayName": "MongoDB Username",
			"description": "Username for MySQL user that will be used for accessing the database.",
			"generate": "expression",
			"from": "user[A-Z0-9]{3}"
		},
		{
			"name": "DATABASE_PASSWORD",
			"displayName": "MongoDB Password",
			"description": "Password for the MongoDB user.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{16}"
		},
		{
			"name": "DATABASE_NAME",
			"displayName": "Database Name",
			"required": true,
			"value": "sampledb"
		},
		{
			"name": "DATABASE_ADMIN_PASSWORD",
			"displayName": "Database Administrator Password",
			"description": "Password for the database admin user.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{16}"
		},
		{
			"name": "SOURCE_REPOSITORY_URL",
			"displayName": "Git Repository URL",
			"description": "The URL of the repository with your application source code.",
			"required": true,
			"value": "https://github.com/martin-morales/sample-openshift-php"
		},
		{
			"name": "SOURCE_REPOSITORY_REF",
			"displayName": "Git Reference",
			"description": "Set this to a branch name, tag or other ref of your repository if you are not using the default branch."
		},
		{
			"name": "CONTEXT_DIR",
			"displayName": "Context Directory",
			"description": "Set this to the relative path to your project if it is not in the root of your repository."
		},
		{
			"name": "GITHUB_WEBHOOK_SECRET",
			"displayName": "GitHub Webhook Secret",
			"description": "Github trigger secret.  A difficult to guess string encoded as part of the webhook URL.  Not encrypted.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{40}"
		},
		{
			"name": "GENERIC_WEBHOOK_SECRET",
			"displayName": "Generic Webhook Secret",
			"description": "A secret string used to configure the Generic webhook.",
			"generate": "expression",
			"from": "[a-zA-Z0-9]{40}"
		},
		{
			"name": "MEMORY_LIMIT",
			"displayName": "Memory Limit",
			"description": "Maximum amount of memory the PHP container can use.",
			"required": true,
			"value": "512Mi"
		},
		{
			"name": "MEMORY_MYSQL_LIMIT",
			"displayName": "Memory Limit",
			"description": "Maximum amount of memory the MySQL container can use.",
			"required": true,
			"value": "512Mi"
		}
	]
}